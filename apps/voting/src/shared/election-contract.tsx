import * as ElectionContract from '../__generated__/election-contract/module_election';
import * as schema from '../__generated__/election-contract/election_schema.json';
import {
    AccountTransactionType,
    ConcordiumGRPCWebClient,
    Parameter,
    toBuffer,
    UpdateContractPayload,
    CcdAmount,
    ReceiveName,
    HexString,
    EntrypointName,
    Energy,
    AccountAddress,
    TransactionHash,
} from '@concordium/web-sdk';
import { TypedSmartContractParameters, WalletConnection } from '@concordium/wallet-connectors';
import { GuardianPublicKey } from 'electionguard-bindings';

import { CONTRACT_ADDRESS, GRPC_ADDRESS, GRPC_PORT } from './constants';

export * as ElectionContract from '../__generated__/election-contract/module_election';

/**
 * Representation of a url with associated checksum from the election contract.
 */
export interface ChecksumUrl {
    url: string;
    hash: HexString;
}

const grpc = new ConcordiumGRPCWebClient(GRPC_ADDRESS, GRPC_PORT);
const contract = ElectionContract.createUnchecked(grpc, CONTRACT_ADDRESS);

const registerVotesSchema = toBuffer(schema.entrypoints.registerVotes.parameter, 'base64');

/**
 * Register a ballot in the election contract.
 *
 * @param ballot - The ballot to register the votes for
 * @param connection - The wallet connection to use for sending the transaction
 * @param accountAddress - The account address to send from
 *
 * @throws If the contract could not be updated
 * @returns A promise resolving with the corresponding {@linkcode TransactionHash.Type}
 */
export async function registerVotes(
    ballot: ElectionContract.RegisterVotesParameter,
    connection: WalletConnection,
    accountAddress: AccountAddress.Type,
): Promise<TransactionHash.Type> {
    const params: TypedSmartContractParameters = {
        parameters: ballot,
        schema: { type: 'TypeSchema', value: registerVotesSchema },
    };

    const result = await ElectionContract.dryRunRegisterVotes(contract, ballot);
    if (result.tag === 'failure' || result.returnValue === undefined) {
        throw new Error('Failed to invoke contract');
    }

    const maxContractExecutionEnergy = Energy.create(result.usedEnergy.value + 1n); // +1 needs to be here, as there seems to be an issue with running out of energy 1 energy prior to reaching the execution limit
    const payload: Omit<UpdateContractPayload, 'message'> = {
        amount: CcdAmount.zero(),
        address: CONTRACT_ADDRESS,
        receiveName: ReceiveName.create(ElectionContract.contractName, EntrypointName.fromString('registerVotes')),
        maxContractExecutionEnergy,
    };
    return connection
        .signAndSendTransaction(AccountAddress.toBase58(accountAddress), AccountTransactionType.Update, payload, params)
        .then(TransactionHash.fromHexString);
}

/**
 * Gets the configuration of the election contract.
 * @returns A promise resolving with the corresponding {@linkcode ElectionContract.ReturnValueViewConfig}
 */
export async function getElectionConfig(): Promise<ElectionContract.ReturnValueViewConfig | undefined> {
    const result = await ElectionContract.dryRunViewConfig(contract, Parameter.empty());
    return ElectionContract.parseReturnValueViewConfig(result);
}

export function getGuardianPublicKeys(): GuardianPublicKey[] {
    // TODO: for now, return a generated set of guardian keys to be used for testing. Will be resolved upon adding the
    // guardian keys to the contract configuration entrypoint.

    return [
        {
            i: 1,
            coefficient_commitments: [
                'base16:D9A7512A996C43AF04910B32EB23437AC9125C1685C12D311D6D94016FF378FFE3F97D933B8B6AD0AEC80180EA07679AED8738410209A177BB00324DBAED4D04861E207A7B6743B3ECF9566407A039BCF1F9675524A3E591356ABF9DA736077723FFED612FE195085C6CDACF852111C4E79A6120CD6A981F824D6445666527A11EA156CB079BBCB6332AB31367F403C1290FCF936EAEF3E59023DE1AB1E0C091C3A1659FF4F706F12977FFE1AFCD1828264E65BAC3A80AA8DC7846F2330FA10C89460FB563ECAD69C23BA9E5BEC63B54C2E484E8F9C9B6702E83ABBF4CDDD4E59A8FA71FC94C6B106A1BA2CD3F759F46BB536FEF31507BCB6BD1867BD2553605077F88632A6A57EE3DE7458861C71A723784FE712BB9055EE3042B23D7427E3EDFC2B737D8BB262F4669C7D9F0DA0F869C7C0EF163242A0AD5EECD2AF16C72202BA15A0084FDD603753B5823A262EF918D602614425088C4606AA718A051A67C5FD08DCFF437941989CE02E1AC36F058CD427BDB056CA11386F52EB0734B9BBF5BC39890EB42CB9E42D417B32BE91D8F73494AA0BD62167738DCA0764A31EE29F6BADA16E876E6EBB13CE53E2403E37DA0663595E6C4999F7C2BF400AF7DC320347C5D8DCA80AD04064BDF47E37EC20A394BCFCECB0051FDA0004A5125FF484907E12E1A5818D8E799FCFC4B0C5DADB01A1389FCEBF0A4F70613123C80614BC4',
                'base16:A455648088AA50F64A0DAB2E680F2E781480AB437008898CC6A0BBA337554AB641E7DCF6EB578DF7C48B03722959C103AA789C8183E415EB4E1B702C5063CFF2499328BDF7C889F4BC1BF3790E89BBE61AF6A69C09544AF79B834E7001570F1FB2C2FBFDAC5B76A6752B998D2E6B54911FF1ADD2EA93BBF63BAE260D01D69F2DAFD942E1AE460D875DE117D541845425DC74053AFE24114BB747E180ECD51CE4A71FC00D428AE68829871900DB69D6E1F62649BE304155767E89356AE7403640BFFC82FF9E273607668538012D407179978E5EF69FD73C1E402D9344022ED6988E979DE8F112C09A3F8E49E3C5C0F75F48EAF6B37A2239323454A1D702611178746E32DB1D4B731828C51C20D766A67F6311DF1B7900EE869F0977EF265A2647AB274747A32107C44D667044BBCC62CF5450B0F43E1CBC0C4406251B44DAA8F4402FD3E363F0F166B2ED19A34699015C3D5C09C80899F33EE15A2B34D530AF7825F72EC4DD7BCDC4941146F4B3663E7F211F8651BD4BF92E784713543ACA29A94B9B99226E7CC3281706499078B82173EA91C25BA0D3201B05C1BCFBA929E9D1C0E9D1EFF56EFD1775A63A8429C9DEB794AC66D3C6B4AD3894C35F18BAFBB58E6438CADE91C07480429756A5B6151EC8A5B8EF6E855F2258BAA066FFF66F4A6685608914ADC88E9383571D3F9D560E9D6977D82FA5A5A13E0419434F0BDE9CD8',
                'base16:368D5219D076F345EFFB26CC543998526B8355F30BBF6EB1D7902FBDC14158ABCB4D3E1F579B9DA0DB8A346C459F9E28AA895A74EA81A621422B97503A4F9BE867B832B743FBF7D0140EB3BE563EFCF88F113C3868485FED20C1B9068079A655013677F02219AC549E7F1FB14CB1DE51C35615E6D0F4816ED28A40047126EEDFCC9F15FE28762BAEE58736BD933CC8A211DB3D141856FC5B9DFD77915AF8F2171461E8DAE7DE10E6F5C0BB3A81DF62DF9D483074E2E30876BF21E94A77A59E42AC9019705FF74ABAFE920286705B21F79B8FC2CDEFF62E7ED4DBC2B217414C8B2EB2AC032BFF7958EEEE084338CA22BCE6E48A82E3534456B0049A57246FEAB6F95FC3286CFA11B93BD73AAE3DDB10CDFEBBCADAFEC881DDC72E0ABDA178B8C4EBE1B0460321760A855B01833D1D07DDECD853F0AAA2C760D965D3756909AB104454D80134DC96C67C014E728EC6167491F4069A5EDC50D45CB08CBA1C8CDE76B75445283A965D4B1E45639A79E139AB480171045B596A3DC8132A5E11778053E4B652F8B5482FA98790334FB2986BC6DF3FD9DE4620DB65E8C6B5D6DA4D8EBA9C21EC16C71BF47D1D713DE3B27FB65EE8C3FDC3F53DDCB68B537DDADBF23C036547BF06F581EBC5A46DA8D95847F75DC2759AB3138FA7A3B7A0653806CFE0A6A5D6791B99FD4952BF30391ADD2906964715C1C71CD467FA4285019B342EBA6A',
            ],
            coefficient_proofs: [
                {
                    challenge: 'base16:75E0FC4E0D80D1010610CC21A52BB8AEF823E187B32028F1806E269DCA1F4E58',
                    response: 'base16:DEE0F122D242B2A47BC535333DE7C73F6BEB1196413C0329239452779937143B',
                },
                {
                    challenge: 'base16:99F059B94005B63DB69EBA49168798D801040AA9523F81EF0D71EA6DFC83B90A',
                    response: 'base16:B3D08D111C0D969ABC720A06987455C1338DD3A773D9A2526D9E34EDC6117462',
                },
                {
                    challenge: 'base16:6167C6EDBB832CA0DD7EF00A60FD3578FEE4E9E5EE3589D39F0E57696B78EBCA',
                    response: 'base16:BCFDF26882B7724C31CF4414B25D6EAC2A2EB10B73205FFA4181F7EE59D7715A',
                },
            ],
        },
        {
            i: 2,
            coefficient_commitments: [
                'base16:E78109DDE77172FA39F93254090CBC6B43234D6ECE1995D808CFC89263A8AAC0A058A338636B5E767FD6C9D460FCE8F7A411367E41CB6899C29786206CE4AC973EA99E88393FB17706E37BF4E8BF888AEB11CF69ABAAAC1B66B9B190A746096BACBDF8A05D1D15654795E237F79450975A910E382953DFB478E1DCB116A37CC5E35B0D5873E257488ED41E725ED8B794789319D581CCA86203DE06B08A06C1C4CF136C54A460E72031CDE73488E01DE614EFD124BD4FBE5DB5223A63A39E9084C524FD5DFAEFDE722DEFA63F4DEA3C1576C44EA3DFD9075EB625F14418C4FBA217FA50F7D1E21D4E5E3AD711D1563F0BBAEFF94B2592F6B320C11C4271084DC722BCC1BBD406F9B8D3B6B3E27D3A746E628AC59DBF26971041CBC81A32CD7CCFC6338BD8A07952BAAD97360A1FE75847CE4EF93A2A6F93B3294525284182FFE1C252F9F4308D7051F1039D1CD678F4C768ADB4471B4C9BD2B24DC93607F63AE30D5A04AEEADDC5264A8E93575A1DBCD246830276D6F926416596C31116B71A1BB75B1A9D59380A869BBEDC7D0775C5009CA9D1A144727E27344980D3F7EB38C7DE3B8981250D61C34352D233C1248A59D2E6258E6F019295019E73AC0B97B305D29C4147494CD7AFA89C5518F9E2D48AA86CB6F171B483599BCCA88D6C76302FCCB2C80056E7F0B9C01C3998E1EDE33CF16632AB890793FC9C12CD5A45343C1B',
                'base16:CC3DCE6F2ECEC8A20832A9C1292277677F1DF93EE2F7B16BA848E2894518C720695792ED90D7F29BDA206F6FB8F942DEB22C39282AC543ED7D373DD5439AFC59055640837F282DE6B5AD118F78E33B6B534F74FC1F7A9547E06916BDB84216AEB6548CD3E21CC3AB281CB934C352B6830308DA728C8982ABBB63C4BF02DC73AC35DB621B712895C06E3038874D49DB56CCC10F40F1063B7E9F3606FC9ECDD05DD9FDD809F94DE6B370C82BB7CE1F438562935EA211CFB312DDDD963EB3A6707EECE513DC69AB1236E5F4F6252A2EBFFB33215BC1CB73E0AC14078E6188BD9A069B63F67BF0FB1916EB1FC2DCF1DFCBCDA7D3F27C540618FD41ED051C89CDCAD2C79CDC93EEA796AE73618A25ED26B7A793D67FE53C882007F593B0C24F9E501ED5883160ACAF3D051DA78CA1A77085C8A09398597A114FBD9DC1A2DCAB77781159400B7D02912D0EF811AA8DFA59394F3BE23567C98FD1EFC19937D50015FAC51E08A8E7CCC8195E40ECF0A887F9F7C63A1CB298703E918433005C38B5F5FA206C57150A1B7EE9A30DC1E91D5CB94640517DDD58AFF9F07347BBD3288C86524C9A9F42FF836EDB0521E7B41815BE5C7763B97F9459DEBA233B17827835C72DE56CC9E662259DFA9974CBD3A7A0601B9454A4B5E889D2227ED63E3645E6621421A67A6E4426425E34DF4C12D73ED40342426F9187F75EC2EC91E41D1CB3E80615',
                'base16:8998234C704DA2B6BE363993E18AD686A9A0D36355771D849F6DBA995D695AA7E6C9A36530EA66B967A3F79EB1FF26029AF2CC105EA78D8FAECFAC8F90B44132E26D65B1473F18361FBC4088478DE0DC96D3717A7D9E729C94D46E696E88EABA482A7A49127990FE1B9E1249DE9BBAF5DE6E66294DC3FBE8C25250E053AB390A9C0323E74DD86756FA431613F72C65386BA1107E4E5F46013B9127C7798DBBEFE3EA0D5928480D11781DF2C3B16456E0D6F23111F56BDF2E8A275628CE5668D720CF9B640AF64A752C4ABE9FA9CE566BE13A3F0B28583C6936CFEE4EBA18A071CD2B8462E622D590E5DA3FF3F9C6F76FBDA38D72777AA77D29916F760019C38C37B9DE194D38112C0EF2D1BE2A3F9484F8D61C6A84ECAC4BA48FF09195A5654ED74BF18CFDC9FDE4A0DF21171C092DA6BAB55B6FC4824AC871174186BC8658BBA63B97CC7BA44E19F5652C60A4E403FBA9ACAF1CFC05793330D421178FBF5BF309588320007FB9F0E16007E44D70D39492C984AA4C137D1A128C0E7C80241B423E2509A9B973F24636FA8F23062DE4A3A661E9C9B1A980C1806D2A8AB3614494171151536B3CBB936EBDD1752E5D8E0088CD02DCFB65FB5B1EF4AD8BB234EF96F6B5D0D2D4FB963F3CF7C62958BBCA8C4DA96FAEC43CD707B2F0B339089B7CE9A38A7CB4CA3A6A0C414A343ADBAE78049C00FF7129E1B7B1081E276F5B220C72',
            ],
            coefficient_proofs: [
                {
                    challenge: 'base16:5F80F5E541DDFC529D31D2ADCE23D3523C5F422801FCAD2060E0A1AD61D1D0AD',
                    response: 'base16:9C88DE0F5F7D2F3A1927DF74B97C0F9299861C73FB9B3448B28C0B57CD6EC4FB',
                },
                {
                    challenge: 'base16:A91CD2DDB31030BD1C658CB6A6FB361B0241A138BC8330DB2A57A356105FA985',
                    response: 'base16:CB68A5985E3F22BDC9B3734BFA40FDFD9A6227BCD75D2B7DA164C169F00C228C',
                },
                {
                    challenge: 'base16:47C44025F2E0A551BDEE389856EE4E8EFC308D768E2DB2ED425D91D63AA2126A',
                    response: 'base16:8EC5B15F1F486B42F699F7277BBC2AF92B782517BE14CE5220986FC8CDDD54F2',
                },
            ],
        },
        {
            i: 3,
            coefficient_commitments: [
                'base16:C0E6DD5BAD95146444EC29EE8CD999A52AB0DE0D9C8962ADB1E4B27E37B50C231C05C94AB40771B3B5DF392090CF099C58710990AD0EE27E1C74AD5778786C9F0BF8CA9F792AE5BFB04256B4D76ED46ADADEDD0D3FE1BD9CF869617E91BDD7E78FAD1385D83AB40AD82C0BC67F11BE75234C8FB4270C1589BBB7EB44E06B5AB6F3332971BEF8EDBB1A30DC9ED0EC330BAAB0E8BD06DB728CB4D48B621893E932E82CF7872780BF4E4768E14409BE9F764ABA5919B3E41BD69B8F5CF7E4CC1C5E2D32E6693B5B9D3212919083289B291FF06694B6681C338FE55C69212F60D4338CF737FF5577646982887E5158A4825CDD2DD1DC1C2A1DEF8F98885C3929ADEFF9F82C990E9E303946B0CF5047A653EB50100994581E8D45A532C85FA9BE15492240179D9BA57D591EAC982F6C079904F7060D492B9A48E8436AB4D39534F7E89C5EC900985D4F06E8EC21998ECE1EE6ECC2C0F54B2F072026223A545208EFB449BD4776C365AEE64F45F0057E72BCA4035D84D6FC7116BF231BB42E5EC7A1C20DCC7D780F9357E7ADF19BD53A730251E70553B248EC92F9E86524D5218D77225CD6477CA67F2E08A5773454FE4091953510F12F8C9B94294489040E2491965F0815D2982FA6882B6D886A8638375BB768D3072863F3B077CBB4EC525AA183E2E8C77D62FE54A813A99BD05B8248AA72826D18B8EA8E8CF569CB639F4DB89F3E',
                'base16:F83E05DE7EEC3659167AEF6E07953B49323118CBC7A7F117FAB99D14D8C44B5E09D67746C97BB323C7BB8F8A8660CA07C74D8C4DA642423ADC66D1773CB1151AAFF8D781A78305E95FF1A77BBB2E249BDE94FD708ED495E92C1E2EA56875D853D7D7896C19B60FA237AACBEDBEA2C3F010D32A8D012037DC4DB1CBD42E68FB60978A3B3E8609571ABFD6AC5F84269FF4A65DB1F7F72FE884454712CB16073C8E09904A352782D251955724EE820668541C88A392EF010600BA89F9ABC671E230E176E7358BBF9A7F78E87E3B52F2F41D8DF1BFCD1E04A25D8E84798525D34FBE92E27036D9E3E84E741F2391CE2187AF3FD2CE8CD4E13D7F7285C5E61FB74B50CA699876B4B1F2E841C18DBA201CF4FFCE5D6808DD1A05F460E1DA80C82ED67FE01DF89C4B22BE36C9B7BC4B153CCE94E2AE612DFB77E3AC796223BAC9E3EE63F74CE961C5BB56C78880F8E32F364EBE42023D4C7465E786BB6212CFB58A8AD0557A8EE2B361239E68E9B3E7F6A4EA35138D235EADF83E6FD0D3EBA95E5F4862A93C90C97BEE76C6578A6F2CE2BCDBB7250589C9D0359A8DF067816994648022A0AD0FD4F3026D59213464BCB494B9471E781CF5F87450F349F3786C1EC22E7D5B7B7B22D3DBDA49BDD6D92B3A59D7F615007CBCA88453BB1119066BC4E34D65971642E88CD2F7B387A36EE9DE264B81FEFAFAA8BADD43BD758BDE837CD9C904',
                'base16:1A70CE2E59E0CAEE9322118F72C1B173303F347C834F71CDD023F0E753FBFF1F3D7ECC68E388DB60741F051C1E98F1E6CBF8985EF201B8347E786D20E28F2A9D79B41661CC237338C7E0073FC1588C7BFB3801D4F255F92B62D2D9CB012F3403FDD5992C7CB70171D1C86FB2E7DF9592D92B211EB53432D3E195D88134FF767179B7EE40BCE84DEE058A68B3011711EA370522FB4FD932E2A9DD661ED056DEB194AF6E3C4C6F11B1A320C58E3829658BB14FE9ABAC3DF75CCDD553CEAB5B27DEB99DBAE6FF822C4F99C43C760EB5DE97AA411D340FE0CB927C970CCEFD28FD89472404960509D340666A805A61F5C4C8CA1B8B286A27C6F2DF7CA553E7504E3D7649ADE80BFF548D4FFDCFC633B00F4B3DC4B701589D0D78DA6D20EC681A4CC5ACC1A40124A088B949410F6FB11C2DD0DF3BA9527F48ABFD39E0E47F8021B0E5CF7E72B52C97575D2A52DB4DD1464CE5D692E32AC0614D7A367E78724BC5FCF9DB10893EDD4CDE2315BB0DD13304096D2A7CBB19AAE0FBBB67FCAC0CD2686B60F1241A7BD8FD45589964D28E7A93F67725AC64338FBFDE15087A9495ADA6B259F1E7EC1BAEBF029CC2AE4527A012C0AD1BFDFB666E6A4F9FD38C177E01D03D2B80EF4FA2C1CB9C843E8978B753B5FC1349DD608604BB85F45D26633F5669FAEAE5B4313241D52BA2CE97C4CCF803DDB1D54394913076511A8BBC5CEBBCF32698',
            ],
            coefficient_proofs: [
                {
                    challenge: 'base16:1A53650DF226CE0CFB6FED8101423B469040AABFF4A15FFC33194CE4B1D3CFB8',
                    response: 'base16:D67B610D638AC7B599D368E44749DE70D19BEF3C68D9251728DC702450A84E71',
                },
                {
                    challenge: 'base16:BD16D7DA6053B2FD8D83BB025AEBFABDD741A486CA53A20456D0EF587B02E005',
                    response: 'base16:2BDC70236246F678AA706912094C51A52996AC74428AAACAB3F704DC9BD3DEB2',
                },
                {
                    challenge: 'base16:27B26874DD6156B8AD7E5E254413634E8F5D974BB4D4C1BDC9B6139D2471C4D1',
                    response: 'base16:19E274E27E6027F59C271090FDD0B9F85A59CE20ADC95086A69DAED2B183F0BB',
                },
            ],
        },
        {
            i: 4,
            coefficient_commitments: [
                'base16:6A247D15E5694A1E08933EADE24E1459A3D167D411D8BFC99C9BDB51A15AA8E78C583E2515AC11BA15EFC29777972FFE09D9E20062935AE8AF3964C3A33FDC199409707D4DE69566D8AC89C670547607ED2986B3F65F4C05F032E29D065FB8D60DD727A6608DF75951601AF6BA4CA6E5EAC21FDB433E94AD2EB6D3F996D2E03D80E0D29BEAEE3C4773F2A3925918182EB1FFD64314EFE52C1744F8A4CE81AF4D4E83D2C7EA54649997E9DC994440BE45F5BA792279AB2361984B18207647D032A0FCBD10A9677D42335C4C7F64CC4DECC11E4675C530DB6E4D916AF8C4597648698453DDBA2F025B0F1F6806A07B5512751A2D3FBF3E613379C808C80B4F9664B0326D98DB1B4AA220A838607103A8D35465D9410FCF3BFF212BD2B5220F4BB1DE0717DCB4D1E178835612DBD391EF85DFDA631DBB0D61914F75A8633F226E173EBE8C977576ABFA236A3FC676A3897BF2F7B854DA6588D071F63CEC9C956F10854EC7357543E841D8544AFD6C4CF3F0843858B96E48E3AB73177F8AFAB7F6B9F4B3D568B204522EF7B70050ED3B3996359F1926F1325BF9E52F4AF1E36FD8B8FAE89863C8C10AF7C503F79786164F11EDC4EA9F0068826848AE6EBA342DA52A310BE6B6905419058881D8E0DE774B8A9F4A0CE4ACAA08A8D2405B9862CDD8AC7E5333F808F1A8B47EFB49DBFA2124A641540BCC616CBF04A1D3485115137410',
                'base16:4BCC6D5A27904CE31547DE3E157EB05FD527F0BAB9A36BF213629C13733A67B6279CBBB4EC8D78A1078198FDA627E5D53BDD964C9FA5BF99EDDB95B1F81D4A2DF2FFD7BACD44C9B91BCDDAD3C04FC982BC7E8B79F406D98E37D29A2A4571D98FE86F73AE98CEF884876478A7F37A25F6F1DC275C8BDB6CD292517FC5FE4428A0C854F6C447052D92B9AD31A97592C88052FD5B33582D8D9F81EC1A516ED6039E064F12D46F1FB53A198A8846581C9B8363413F311E78C6007C0984596276EBE7E21AD3B2909609EDC0F034F327AEE48EA0622D8846C39FC2F0B4D3E841E3256E121777231E0BB7EFAFD6F413514022F5F9AA939583F907555B64C9AA8CA784566F937A267F1A9CBBC228EA5E8F244CA94792387DC36C528EBC7C3B38851B95396424B2D5F5035B7A2E17002249202F41A9280714E68BCC5A187A06015E99DD6B15C9870B87DDF59418F38CB908EE359A3D6E4B6718AAB7611713F532568C4B6C754514A90BC08B0E22744B288F4430D9DA0D396B2CFC9F38A0CDA6208FDD18BBF14ED0E176948F40167CB1E46527BC49F980BAEDAE67CECA200554F4F8680618FE84FFB11FDE4A513CF6F05ED7963C36E15DBD57D7210DB39A475C4E60A17745C33DC86F1FDBAD6989A85876BE6A0A40861DBA17E77A163F2A1BE2D1A213E476F409399653933ED6778532D3A95CF43976FCD705C168B95C2F3C6BFF86B6AF9C',
                'base16:1E6DDBD066FD66EE70144730A24D6F2395D5E9BB9F07F4FE7177CFDB634E6B7260E3062CABBEDB529D547A7EF8EF7766BDA3B32043BEDE1C0E7F9A1755F42AB05A0B534B7C16DE50F4A36B3F5FCC879AC58015F1FC3E1560BA0928CC4734D3234289519A51A7E1DE2B72308836AC9D6039F250D0EAED0FA526AD9830E44735FFFEDCA5C58628B7DE59B5801814BB84994D587F5DE1972A0E2558B0CE92A50A78E2E958A054F11B6904DBAD297035C538003666131CDF5D93D8D2D247C0A900D987B4E1D1298C151A6A99B094C0466FE941E62F3F1FD35013860C14B2FC55C2C8EA04A2D9B622BFD27306C36495BD5B3FE2EE195577A1A6CE4F9BC5056863F324588D6692E76398ACF5BE3D85A4ADAEAB9E4993943171ED34C89B5D62114CA4DB36D2EA06E2C649CA5358FD1D6167EFB0C219D3A0711C6C8F0BB71929E8D1FBB7BB7B87027DDB34168C3DD6EB327BE1CF130A9732B4907D9BEF892A5C5EDF9946183A608A7B09B4027528D081B52B5BDE048BF488C60020F493EB495C75C524489728DE110CEEEC5B887A9EFF9E9762493F5521AA49D1AC8D5CC134219D74F57875D06436BBEC77102371BF8367AC1B050A8835754A927F2EB5C4B28C3D004C0795936806DEDBC0A4FD298127A6DD51C44DC08FD82292D760F5BBBB143719093B0A2B6D06577EA6979D6A436F13DE348DBA0F9F8DB15937B95F5C9DF966B31793',
            ],
            coefficient_proofs: [
                {
                    challenge: 'base16:CF6DE3AEC34A4178D4602A5804F83717683C8818DFAF7CF05D68803B8F86B542',
                    response: 'base16:DDD230C23ECF7771A3B320C3A72AD11087E114545ED2FED63893B16A7553F666',
                },
                {
                    challenge: 'base16:56ADCC9BF344B992E34824BD780DFD3F4237BCA12DC4309403799DAC7B3517BC',
                    response: 'base16:BC95DDCA200D20870D2454D7530D28EAC184DF4471EEB91D79831BA8D86455D9',
                },
                {
                    challenge: 'base16:B810564944E09431133AF5F293D5A5828BC81A5B035BC23D4F3FA6E0475A05A0',
                    response: 'base16:95D18D84F6FFEE0E95BCD94AE943FC3C510DC68E30ACDA6E7F7FCDC9D7360257',
                },
            ],
        },
        {
            i: 5,
            coefficient_commitments: [
                'base16:FB1B729E001D1C0B31C07579720DCE1BE24C9429A8A8A63ED49AE2B1D6B386B157767A4F2866410647077C4BAB18D10940FF216DDFDF40E2F8CE68ED6FEBF72EC2474D63E29B87835788D4A29DDFC61CE10DA12E82DA40D168DAFE9B338ED49422182A3655BE8783CE1F51EE9DC6BF27AE0DD14E5ED67DC5B78C26873A0D6DB729FFCBE8DB6B5DA5119C21FB785023EC4F261E690EDB414AEF5A5E4EF373C3C408612475ACD4204E417E79AF9A5E79C8F54685814347595CAD96E67C5F43FD97D0C8F48944D2401F5DF12A3ADA689AB600CD2586689D9A73F27CE721C7F372C6A8C63BDE1EB9D98BC6433F5EA22936272B756A6733F5BB43F498C92C17CDE36CE229FE5A01A52A9C1D97F2341885608F0D88DA303BEB0D8535AA8C8C85274B038F28CE30F5C35CCD3BCE225690B74B55A0EF2D94D000CD19402050CBB93A1F2528B55AF7D2B13D0D1FB7666EE1560E33E43B3BF3999D859844846915D65BD244AC8002A1D52AA8F7858302B1814FF2B0BAA51A396208D53653FBDD306566B96DD38C76CC80177954AD8CA4E2B57511993F93ABFBC4FDC24C75666B1B59B8D92F1DC019EFA0B8CDBB9E564D459D6B5F64461C5B164D9BA1D2AEEDFAD21407F524CC1451C1B0C7A02D63CA2DEEF6CE57EA90CD216F7BDBEF3242928F2EE3767A809C42313927852A130B7C5CBDAC33088BDEC3E008895D074591DFE4C24C312046',
                'base16:E5C82FF76582913A64438F55DA0D7A2B1AFEF05ECD5097D157A0F39E7677D641C58DC2BD0919978FB54D7CA8F10426E260E0549940B3A355494FC21335247D7A09AE86D7340FD9741D925C430EC1B5FBF2A94C225A52B0507C3998F01A33D97766750D561AB3426C3770AEDBBDCF8FCEF01548A4A1E55A00240D5CED34F5E854DBA46976A6A7284FCEB98C83F45960061226139929A367ED7289CD68FB01FC73AE3BC4C9840C31653711BC9D1320A7491DD054C84525CFF9418CDF8356E4CC5EA8629D9B29DF093ACD310E7A417EF68E4B79B167986EBFF8B6050B433F78F5E50D1F7D5E6277F61C7AE59D0ECE3604B5077BD994F899A2FBBD442E420DC25BB0675623EBB41061D0BABC1691DB57BFA66E1B178AC3B5DF8047C9DB3B1C44212AA9274AA819F31E694D3477E62B8C82005D7ECB89761746A5020079B919EA5B5EF41E904BDC238B11257F987B96B86E861627F280F01AA8556748AC5E4ACC3C7331EBB5756C2FA3DB72B5129C99C98CFFEE636CDBA681AB3FE5A20AC71F80D9D77073022CAAED59B1A74BA33BB61239A66CAE023E90E2F2161E1CD505FBF3047C82D0C0A3205AACF3F91A77701D739CDB01C715AC72F48D96C566FC39DA1677F56F80D7BEA819BFA32F0018C5D336B29CB8A5B6B00645E860C60521F77C65589526F2A54D1C5158FDF595D2A55DCB97A42042DB05C81A2C15FD69A714160EAB0A',
                'base16:5FC02B0C920F14F8F519282A106A6B4EB489AF8D113176DFB756243DE60CCC1B3069FD83A387064F4FF311CA58859F6E437C524801A5B591553EB4B7C56C3F14F52B2E9AC7AC7A7C335D1B244C28C827E1542061318D50BDCCDF4939188AC8D96ECAA346A28F438657CE6B583793513ED0F6D6130827D0FF9477FA92D96C9D76B58ED4D6464AE6CF6F494112F4E89AF97ACC8A33E099C18500B23F4219961D3556C0D5C4EC014AB26CA11F3F7F5E06A0AF64DE051290ECEE34D66CC7643A8EE691DFBB565CB268FF2F08DE67055B4DA53F79E49153530EBFF2F907E2100186D5111106BDD2B318EB3AD3D8724BA37ADD8482A498FC96F5EAC3F490A3C9D63AB8CA85D7C827B7FE3E6C71F28827CB9396AA196532131EB48FDDA3117C6C0B337CBFC5EB36DAACE63980A78DE6FC09A36FE7AA1AE8A031B1F5F9E1B2B415531B801B03D466DEF164EC5F782B0A665CC7B5C8168E22ED1CBFD153C817682FE5E495083870D4FCAF1C3119C861CC35E4855D42DBA33B183E4EB9E51A8A4AEFCDD915521AA4580635920DEDFACE5DCAD40955225D3793662228A9716C7B018E7CD83652959F8C553545E262CA0A0ED6C255445CBA6EAF2786A21B6C24B4F4A251A0D615E006C091DE7296A60D9D5CC64268F45C1A6C6541AA584CA4546C519D53DED3DBDB8B4B6B2CF5247582A0FF0A7041D6689239421EAC8CC4ECCF36A1A87BD3A3',
            ],
            coefficient_proofs: [
                {
                    challenge: 'base16:AE1A7AB3CF5DE2772F32BB41510197F60185041F76855AACC96B1C8314D0A35C',
                    response: 'base16:A32917F05DD075C0696A340A5F0117921CDCEAF0BA4A1A698819FE7046DE4A5',
                },
                {
                    challenge: 'base16:6697E0A8B2F39F35056E6FDAA08EB304036219DBA0E98BA7DC47E9096519D502',
                    response: 'base16:D72B9F0B16EB236EF440E21EE73BE30302CFCFE481AC87207FB7BBC4A03D6F4C',
                },
                {
                    challenge: 'base16:6A954A243EFF2402F8FEDCCD09C5B38D6672C99C3A439A145C2257D4B15A9651',
                    response: 'base16:3A5FBD6C68A52BA27F78BBE04C39B1F8BE0B071F8C6956C71C1BFB59EF1F1BC',
                },
            ],
        },
    ];
}
